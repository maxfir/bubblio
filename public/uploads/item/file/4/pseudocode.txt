// PSEUDOCODE - Lab 6
// Brigid Angelini, Laura Curro, Galen Scrhetlen, Raymond Jacobson

function declarations

driveMotor()
	pulsewidth = pw_neut + drive_gain*error
	setPulseWidth

steerServo()
	dE = cur_error - prev_error
	pulsewidth = pw_neut + steer_gain*error + drive_gain*(dE/dt)
	setPulseWidth

setPulseWidth(pw)
	set PCA0Pn2 register to pw

getBattery()
	return ADC_conversion

readRanger()
  Data[2]
  range = 0
  i2c_read_data(addr,2,Data,2)
  range = (((unsigned int)Data[0] << 8) | Data[1])
  print read range
  return range

readCompass()
	Data[2]
	heading = 0
	i2c_read_data(addr,2,Data,2)
	heading = ((unsigned int))Data[0] << 8) | Data[1])
	return heading

global variables
main
	initialization routines
	set pin i/o registers
	set PW = neutral
	battery = getBattery()
	while(1)
		check slide switch
		display PickDriveGain on LCD
		read drive inputs
		setDriveGain
		display PickSteerGain on LCD
		read steer inputs
		setSteerGain
		if 20ms
			read compass
			read ranger
			driveMotor()
			steerServo()
	endwhile
endmain